<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="gpu_slam_bot">

  <!-- convenience materials (named) -->
  <material name="base_blue"><color rgba="0 0.5 1 1"/></material>
  <material name="lidar_red"><color rgba="1 0 0 1"/></material>
  <material name="wheel_black"><color rgba="0 0 0 1"/></material>
  <material name="arrow_red"><color rgba="1 0 0 1"/></material>
  <material name="caster_grey"><color rgba="0.4 0.4 0.4 1"/></material>

  <!-- base -->
  <link name="base_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><box size="0.45 0.30 0.12"/></geometry>
      <material name="base_blue"/>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry><box size="0.45 0.30 0.12"/></geometry>
    </collision>
    <inertial>
      <mass value="3.0"/>
      <inertia ixx="0.02" iyy="0.02" izz="0.02" ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <!-- lidar -->
  <link name="lidar_link">
    <visual>
      <origin xyz="0 0 0.09" rpy="0 0 0"/>
      <geometry><cylinder length="0.06" radius="0.055"/></geometry>
      <material name="lidar_red"/>
    </visual>
    <collision>
      <origin xyz="0 0 0.09" rpy="0 0 0"/>
      <geometry><cylinder length="0.06" radius="0.055"/></geometry>
    </collision>
    <inertial>
      <mass value="0.1"/>
      <inertia ixx="0.001" iyy="0.001" izz="0.001" ixy="0" ixz="0" iyz="0"/>
    </inertial>
  </link>

  <joint name="lidar_joint" type="fixed">
    <parent link="base_link"/>
    <child link="lidar_link"/>
    <origin xyz="0 0 0.12" rpy="0 0 0"/>
  </joint>

  <!-- wheels: left & right (visual rotated so cylinder looks like a wheel) -->
  <!-- Wheel geometry is defined as cylinder with small length (thickness) and radius -->
  <link name="wheel_left">
    <visual>
      <!-- rotate cylinder so its axis aligns with joint rotation axis (Y) -->
      <origin xyz="0 0.175 -0.05" rpy="1.5708 0 0"/>
      <geometry><cylinder length="0.06" radius="0.07"/></geometry>
      <material name="wheel_black"/>
    </visual>
    <collision>
      <origin xyz="0 0.175 -0.05" rpy="1.5708 0 0"/>
      <geometry><cylinder length="0.06" radius="0.07"/></geometry>
    </collision>
  </link>

  <link name="wheel_right">
    <visual>
      <origin xyz="0 -0.175 -0.05" rpy="1.5708 0 0"/>
      <geometry><cylinder length="0.06" radius="0.07"/></geometry>
      <material name="wheel_black"/>
    </visual>
    <collision>
      <origin xyz="0 -0.175 -0.05" rpy="1.5708 0 0"/>
      <geometry><cylinder length="0.06" radius="0.07"/></geometry>
    </collision>
  </link>

  <joint name="wheel_left_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_left"/>
    <!-- joint at the same position as the wheel visual origin (but without the rotation) -->
    <origin xyz="0 0.175 -0.05" rpy="0 0 0"/>
    <axis xyz="0 1 0"/> <!-- rotate around robot Y axis (wheel axle) -->
  </joint>

  <joint name="wheel_right_joint" type="continuous">
    <parent link="base_link"/>
    <child link="wheel_right"/>
    <origin xyz="0 -0.175 -0.05" rpy="0 0 0"/>
    <axis xyz="0 1 0"/>
  </joint>

  <!-- small caster at the back for stability -->
  <link name="caster">
    <visual>
      <origin xyz="-0.18 0 -0.06" rpy="0 0 0"/>
      <geometry><sphere radius="0.03"/></geometry>
      <material name="caster_grey"/>
    </visual>
    <collision>
      <origin xyz="-0.18 0 -0.06" rpy="0 0 0"/>
      <geometry><sphere radius="0.03"/></geometry>
    </collision>
  </link>

  <joint name="caster_joint" type="fixed">
    <parent link="base_link"/>
    <child link="caster"/>
    <origin xyz="-0.18 0 -0.06" rpy="0 0 0"/>
  </joint>

  <!-- direction arrow (rotated so it points forward along +X) -->
  <link name="direction_arrow">
    <visual>
      <origin xyz="0.18 0 0.06" rpy="0 1.5708 0"/> <!-- rotate so cylinder points along X -->
      <geometry><cylinder length="0.12" radius="0.02"/></geometry>
      <material name="arrow_red"/>
    </visual>
    <collision>
      <origin xyz="0.18 0 0.06" rpy="0 1.5708 0"/>
      <geometry><cylinder length="0.12" radius="0.02"/></geometry>
    </collision>
  </link>

  <joint name="arrow_joint" type="fixed">
    <parent link="base_link"/>
    <child link="direction_arrow"/>
    <origin xyz="0 0 0.07" rpy="0 0 0"/>
  </joint>

</robot>
